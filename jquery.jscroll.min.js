/*!
 * jScroll - jQuery Plugin for Infinite Scrolling / Auto-Paging - v2.2.4
 * http://jscroll.com/
 *
 * Copyright 2011-2013, Philip Klauzinski
 * http://klauzinski.com/
 * Dual licensed under the MIT and GPL Version 2 licenses.
 * http://jscroll.com/#license
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl-2.0.html
 *
 * @author Philip Klauzinski
 * @requires jQuery v1.4.3+
 */
(function(b){b.jscroll={defaults:{autoTrigger:true,autoTriggerUntil:false,loadingHtml:"<small>Loading...</small>",padding:0,nextSelector:"a:last",contentSelector:"",pagingSelector:"",windowheight:true,callback:false}};
var a=function(e,f){var n=e.data("jscroll"),m=(typeof f==="function")?{callback:f}:f,o=b.extend({},b.jscroll.defaults,m,n||{}),c=(e.css("overflow-y")==="visible"),k=e.find(o.nextSelector).first(),u=b(window),g=b("body"),p=c?u:e,l=b.trim(k.attr("href")+" "+o.contentSelector);
e.data("jscroll",b.extend({},n,{initialized:true,waiting:false,nextHref:l}));q();j();s();function j(){var w=b(o.loadingHtml).filter("img").attr("src");
if(w){var v=new Image();v.src=w;}}function q(){if(!e.find(".jscroll-inner").length){e.contents().wrapAll('<div class="jscroll-inner" />');}}function d(v){if(o.pagingSelector){var w=v.closest(o.pagingSelector).hide();
}else{var w=v.parent().not(".jscroll-inner,.jscroll-added").addClass("jscroll-next-parent").hide();if(!w.length){v.wrap('<div class="jscroll-next-parent" />').parent().hide();
}}}function i(){return p.unbind(".jscroll").removeData("jscroll").find(".jscroll-inner").children().unwrap().filter(".jscroll-added").children().unwrap();
}function h(){q();var C=e.find("div.jscroll-inner").first(),A=e.data("jscroll"),B=parseInt(e.css("borderTopWidth")),x=isNaN(B)?0:B,w=parseInt(e.css("paddingTop"))+x,z=c&&o.windowheight?p.scrollTop():e.offset().top,y=C.length?C.offset().top:0,v=Math.ceil(z-y+p.height()+w);
if(!A.waiting&&v+o.padding>=C.outerHeight()){return t();}}function r(v){v=v||e.data("jscroll");if(!v||!v.nextHref){i();return false;}else{s();return true;
}}function s(){var v=e.find(o.nextSelector).first();if(o.autoTrigger&&(o.autoTriggerUntil===false||o.autoTriggerUntil>0)){d(v);if(g.height()<=u.height()){h();
}p.unbind(".jscroll").bind("scroll.jscroll",function(){return h();});if(o.autoTriggerUntil>0){o.autoTriggerUntil--;}}else{p.unbind(".jscroll");v.bind("click.jscroll",function(){d(v);
t();return false;});}}function t(){var w=e.find("div.jscroll-inner").first(),v=e.data("jscroll");v.waiting=true;w.append('<div class="jscroll-added" />').children(".jscroll-added").last().html('<div class="jscroll-loading">'+o.loadingHtml+"</div>");
return e.animate({scrollTop:w.outerHeight()},0,function(){w.find("div.jscroll-added").last().load(v.nextHref,function(z,y,A){if(y==="error"){return i();
}var x=b(this).find(o.nextSelector).first();v.waiting=false;v.nextHref=x.attr("href")?b.trim(x.attr("href")+" "+o.contentSelector):false;b(".jscroll-next-parent",e).remove();
r();if(o.callback){o.callback.call(this);}});});}b.extend(e.jscroll,{destroy:i});return e;};b.fn.jscroll=function(c){return this.each(function(){var f=b(this),e=f.data("jscroll");
if(e&&e.initialized){return;}var d=new a(f,c);});};})(jQuery);
